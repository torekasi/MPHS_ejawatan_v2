version: '3.8'

services:
  # Web Application Service
  web:
    build: .
    container_name: ejawatan_web
    environment:
      DB_HOST: ${DB_HOST:-host.docker.internal}
      GENERATE_CONFIG: ${GENERATE_CONFIG:-1}
    ports:
      - "8000:80"
    volumes:
      - .:/var/www/html
      - ./uploads:/var/www/html/uploads
      - ./admin/logs:/var/www/html/admin/logs
    networks:
      - ejawatan_network
    restart: unless-stopped
    entrypoint: ["sh", "-lc", "/usr/local/bin/app-entrypoint.sh"]
    dns:
      - 8.8.8.8
      - 8.8.4.4


networks:
  ejawatan_network:
    driver: bridge
